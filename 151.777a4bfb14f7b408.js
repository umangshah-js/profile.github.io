(()=>{let i=0,d=0,L=0,y=null,u=null,p=null,N=!1;const m=t=>y&&(y[t]||y[" "])||[[0]],v=t=>Array.isArray(t.text)||"string"==typeof t.text?t.text:[],b=t=>" "!=t&&":"!=t&&"/"!=t&&"."!=t,H=(t,e)=>{let n=m(t)[0].length*e;return b(t)&&(n+=2),n},B=(t,e)=>{let o=0;for(const n of t)o+=H(n,e);return o},U=t=>null!=t?.colorSlot?t.colorSlot:Array.isArray(t?.text)&&t.text.some(e=>"box"==e||"box_solid"==e)?5:"logo"==t?.type?2:(t?.scaleFactor||1)>=3?1:2==(t?.scaleFactor||1)?2:3,z=t=>({github:22,linkdin:23,email:24,"resume-download":25,flutter:10,redis:11,git:12,spark:13,angular:14,postgres:15,python:16,java:17,javascript:18,docker0:19,docker1:19,docker2:19,docker3:19,docker4:19,linux:20,windows:21}[t]||2),T=(t,e,o,n="  - ",s="    ")=>{const c=t.trim().split(/\s+/).filter(Boolean);if(0==c.length)return[n];const l=[];let a=n,r=a;for(const f of c){const _=r.trim()==a.trim()?`${r}${f}`:`${r} ${f}`;B(_,e)<=o||r.trim()==a.trim()?r=_:(l.push(r),a=s,r=`${a}${f}`)}return l.push(r),l},j=(t,e)=>{const o=[];for(let n=0;n<t.length;n++){const s=t[n];if("string"!=typeof s.text||!/^\s*-\s+/.test(s.text)){o.push(s);continue}let c=s.text.replace(/^\s*-\s+/,"").trim(),l=n+1;for(;l<t.length;){const r=t[l];if("string"!=typeof r.text||r.scaleFactor!=s.scaleFactor)break;const f=r.text.trim();if(""==f||/^\s*-\s+/.test(r.text))break;c+=` ${f}`,l+=1}const a=T(c,s.scaleFactor,e);for(const r of a)o.push({text:r,scaleFactor:s.scaleFactor});n=l-1}return o},C=t=>t.rotate?t._renderSlides[t.curr]:t._renderLines,q=(t,e,o,n,s,c,l)=>{let a=o;for(const r of e){const f=U(r),_=v(r),x=m(_[0]||" "),S=r.scaleFactor*x.length;let h=n;for(const w of _){if(l<(c+=1)/s){h+=m(w)[0].length*r.scaleFactor,b(w)&&(h+=2);continue}const k=m(w),Q="logo"==r?.type?z(w):f;for(let g=0;g<k.length;g++)for(let A=0;A<r.scaleFactor;A++){const $=g*r.scaleFactor+a+A;if(!($<0||$>=d))for(let M=0;M<k[g].length;M++)for(let W=0;W<r.scaleFactor;W++){const D=M*r.scaleFactor+h+W;D<0||D>=i||(t[$*i+D]=k[g][M]?Q:0)}}h+=k[0].length*r.scaleFactor,b(w)&&(h+=2)}a+=S}return c},G=(t,e,o)=>{let n=e,s=o,c=e,l=o,a=e;for(const r of t){const f=v(r),F=r.scaleFactor*m(f[0]||" ").length;let x=o;for(const S of f){const h=m(S)[0].length*r.scaleFactor;c=Math.max(c,a+F),l=Math.max(l,x+h),x+=h,b(S)&&(x+=2)}a+=F}return{top:n,left:s,bottom:c,right:l}},I=(t,e,o=6,n=1)=>{const s=Math.max(0,e.top-o),c=Math.max(0,e.left-o),l=Math.min(d,e.bottom+o),a=Math.min(i,e.right+o);if(!(s>=l||c>=a)){for(let r=c;r<a;r++)t[s*i+r]=n,t[(l-1)*i+r]=n;for(let r=s;r<l;r++)t[r*i+c]=n,t[r*i+(a-1)]=n}},O=()=>{const t={};for(const e in u){const o=u[e];o.rotate&&(t[e]={curr:o.curr,updated:o.updated})}return t};addEventListener("message",({data:t})=>{if("init"==t?.type)return i=t.gridWidth,d=t.gridHeight,L=i*d,y=t.charMap,u=t.content,p=new Uint8Array(L),(()=>{for(const t in u){const e=u[t],o=e.bulletWrapWidth;e.rotate?(e._renderSlides=e.lines.map(n=>null==o?n:j(n,o)),null==e.curr&&(e.curr=0),null==e.updated&&(e.updated=Date.now())):e._renderLines=null==o?e.lines:j(e.lines,o)}})(),N=!0,void postMessage({type:"init-ack"});if(!N||"frame"!=t?.type||!t.buffer)return;const e=new Uint8Array(t.buffer);t.gameon?(t=>{(!p||p.length!=t.length)&&(p=new Uint8Array(t.length)),p.set(t);for(let e=1;e<d-1;e++)for(let o=1;o<i-1;o++){const n=e*i+o;let s=0;s+=t[(e-1)*i+(o-1)]>0?1:0,s+=t[(e-1)*i+o]>0?1:0,s+=t[(e-1)*i+(o+1)]>0?1:0,s+=t[e*i+(o-1)]>0?1:0,s+=t[e*i+(o+1)]>0?1:0,s+=t[(e+1)*i+(o-1)]>0?1:0,s+=t[(e+1)*i+o]>0?1:0,s+=t[(e+1)*i+(o+1)]>0?1:0;const c=t[n]>0;p[n]=c&&s<2||c&&s>3?0:c||3!=s?c?1:0:1}t.set(p)})(e):((t,e)=>{t.fill(0),(t=>{for(const e in u){const o=u[e];o.rotate&&o.updated+o.timeout<=t&&(o.curr=(o.curr+1)%o._renderSlides.length,o.updated=t)}})(Date.now());let n=0;for(const c in u){const l=C(u[c]);for(const a of l)n+="logo"==a.type?1:v(a).length}if(0==n)return;let s=0;for(const c in u){const l=u[c],a=l.padding_top,r=l.padding_left,f=C(l);s=q(t,f,a,r,n,s,e),"mid"==c&&I(t,G(f,a,r),6,2)}})(e,t.loadPr??1),postMessage({type:"frame",buffer:e.buffer,contentState:O()},[e.buffer])})})();